# HSM - Hardware Secure Module

O objetivo do pacote é prover de forma segura, consistente e escalável uma camada de comunicação entre as aplicações que utilizam a tecnologia NodeJS e o _hardware_ criptográfico **HSM Dinamo** fabricado pela [Dinamo Networks](https://www.dinamonetworks.com). Esta camada provê funções criptográficas primitivas (assinatura, criptografia) e também funções dos módulos especialistas do HSM: _blockchain_, assinatura de XML para NFe (Nota Fiscal eletrônica), SPB (Sistema Brasileiro de Pagamentos) e EFT (_Eletronic Funds Transfer_).

## APIs

Os detalhes das APIs do pacote estão disponíveis na [Documentação da API Javascript](https://docs.dinamonetworks.io/hsm_client/js/).

## Instalação

```bash
npm i @dinamonetworks/hsm-dinamo
```

Para as APIs que operam funções com _smart cards_ é necessária a instalação completa do [software](https://docs.dinamonetworks.io/hsm/soft_client/installation/windows/) do HSM com a opção de [Remote](https://docs.dinamonetworks.io/hsm/soft_client/gui_console/device_mgnt/#gerencia-do-hsm-remoto), além de uma leitora USB certificada e cartões compatíveis.

## Configuração

As informações sobre configuração de log estão disponíveis na [Página de Setup da Documentação](https://docs.dinamonetworks.io/hsm_client/js/documents/Setup.html).

## Utilização

```javascript
// Importa o cliente Dinamo HSM
const { hsm } = require("@dinamonetworks/hsm-dinamo");

// Define os parâmetros de conexão com o HSM
const options = {
  host: "127.0.0.1",
  authUsernamePassword: {
    username: "master",
    password: "12345678",
  },
};

// Você também pode se conectar usando variáveis de ambiente
// HSM_HOST - Host do HSM
// HSM_PORT - Porta do HSM
// HSM_USERNAME - Nome de usuário do HSM
// HSM_PASSWORD - Senha do usuário do HSM

async function hsmConnect() {
  // Connecta ao HSM
  const conn = await hsm.connect(options);

  // Conexão estabelecida
  console.log("HSM connected");

  // Desconecta do HSM
  await conn.disconnect();
}

// Execute a função hsmConnect
hsmConnect();
```

## Exemplos

Diversos exemplos utilizando as APIs do pacote podem ser consultados na [Página de Exemplos](https://docs.dinamonetworks.io/hsm_client/js/documents/Exemplos.html) da documentação.

## Notas de Lançamento

As informações sobre versões de software estão disponíveis nas [Notas de Lançamento](https://docs.dinamonetworks.io/hsm/release_notes_soft/).

## Documentação do HSM

A documentação técnica completa do HSM (configuração, administração, integração etc) pode ser consultada na [Documentação do HSM](https://docs.dinamonetworks.io/hsm/).
